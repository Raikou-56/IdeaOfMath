@{
    ViewData[index: "Title"] = "Scoring Page";
}

@using MathSiteProject.Repositories.Mega

@model AnswerHistory

<p>@Model.StudentId</p>
<p>@Model.SolvedAt.ToString(format: "yyyy/MM/dd")</p>

<form asp-controller="Home" asp-action="ScoreAnswer" method="post">
    <input type="hidden" name="historyId" value="@Model.Id" />
    @if (Model.MegaNodeIds == null || Model.MegaNodeIds.Count == 0)
    {
        <p>解答画像がありません。</p>
    }
    else
    {
        @foreach (string nodeId in Model.MegaNodeIds)
        {
            MegaStorageService? mega = new MegaStorageService(Environment.GetEnvironmentVariable(variable: "MAIN_EMAIL"),
                                           Environment.GetEnvironmentVariable(variable: "MEGA_PASS"));
            string? url = mega.GetPublicUrl(nodeId);
            <img src="@url" alt="解答画像" style="max-width:200px; margin:10px;" />
        }
    }
    
    <input type="number" name="Score" min="0" max="50" />
    <button type="submit">採点する</button>
</form>


